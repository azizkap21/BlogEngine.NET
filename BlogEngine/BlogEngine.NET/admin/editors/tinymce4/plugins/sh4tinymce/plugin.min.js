tinymce.PluginManager.requireLangPack("sh4tinymce");tinymce.PluginManager.add("sh4tinymce",function(n,t){function i(){function v(n){for(var r,u=n.split(";"),f={},i=0;i<u.length;i++)r=u[i].split(":"),f[r[0].replace(/\-/g,"")]=r[1];tinymce.each(f,function(n,i){i=="brush"?t.language!=n&&(t.language=n):(n=n=="true"?!0:n=="false"?!1:n,i=="highlight"&&(n=n.replace(/\[/g,"").replace(/\]/g,"")),t[i]=n)})}function y(t){var r=t.data.code;r=r.replace(/\</g,"&lt;").replace(/\>/g,"&gt;");var f=t.data.language?t.data.language:a,e=t.data.collapse!=i.collapse?";collapse:"+t.data.collapse:"",o=t.data.autolinks!=i.autolinks?";auto-links:"+t.data.autolinks:"",h=t.data.gutter!=i.gutter?";gutter:"+t.data.gutter:"",l=t.data.htmlscript!=i.htmlscript?";html-script:"+t.data.htmlscript:"",v=t.data.toolbar!=i.toolbar?";toolbar:"+t.data.toolbar:"",y=t.data.firstline!=i.firstline?";first-line:"+t.data.firstline:"",p=t.data.highlight.indexOf(",")!=-1?"[":"",w=t.data.highlight.indexOf(",")!=-1?"]":"",b=t.data.highlight.replace(/ /g,"").replace(/\[/g,"").replace(/\]/g,"")!=i.highlight?";highlight:"+p+t.data.highlight.replace(/ /g,"").replace(/\[/g,"").replace(/\]/g,"").replace(/,$/g,"")+w:"",k=t.data.tabsize!=i.tabsize?";tab-size:"+t.data.tabsize:"";s=n.dom.create("pre",{"class":"brush:"+f+e+o+h+l+v+y+b+k,contenteditable:"false"},r);c?n.dom.replace(s,u):n.insertContent(n.dom.getOuterHTML(s)+"<br>")}var l,p=n.dom,h=n.selection,t={},s,i={},a="html",c=!1,r,u=h.getNode(),o,f,e;for(i.autolinks=!0,i.collapse=!1,i.firstline="1",i.gutter=!0,i.highlight="",i.htmlscript=!1,i.tabsize="4",i.toolbar=!0,t.language="",t.autolinks=i.autolinks,t.collapse=i.collapse,t.firstline=i.firstline,t.gutter=i.gutter,t.highlight=i.highlight,t.htmlscript=i.htmlscript,t.tabsize=i.tabsize,t.toolbar=i.toolbar,f=[{text:"Language",value:""},{text:"ActionScript3",value:"as3"},{text:"Bash/shell",value:"bash"},{text:"ColdFusion",value:"cf"},{text:"C#",value:"csharp"},{text:"C++",value:"cpp"},{text:"CSS",value:"css"},{text:"Delphi",value:"delphi"},{text:"Diff",value:"diff"},{text:"Erlang",value:"erl"},{text:"Groovy",value:"groovy"},{text:"HTML",value:"html"},{text:"Java",value:"java"},{text:"JavaFX",value:"jfx"},{text:"JavaScript",value:"js"},{text:"Perl",value:"perl"},{text:"PHP",value:"php"},{text:"PowerShell",value:"ps"},{text:"Python",value:"py"},{text:"Ruby",value:"ruby"},{text:"Scala",value:"scala"},{text:"SQL",value:"sql"},{text:"Text",value:"plain"},{text:"Visual Basic",value:"vb"},{text:"XML",value:"xml"}],u.nodeName.toLowerCase()=="pre"&&u.className.indexOf("brush:")!=-1?(c=!0,r=$(u).html(),r=r.replace(/\&lt\;/gi,"<").replace(/\&gt\;/gi,">"),o=u.className,o=o.replace(/ /g,""),v(o)):(r=h.getContent({format:"text"}),t.autolinks=!1,t.toolbar=!1),e=0;e<f.length;e++)f[e].value==t.language&&(f[e].selected=!0);t.code=r;t.code=="&nbsp;"&&(t.code="");l=n.windowManager.open({title:"SH4TinyMCE - Code Editor",data:t,minWidth:450,body:[{name:"language",type:"listbox",values:f},{name:"code",type:"textbox",minHeight:200,multiline:!0},{type:"container",layout:"flex",direction:"row",align:"center",spacing:7,items:[{name:"collapse",type:"checkbox",text:"Collapse",checked:t.collapse},{name:"autolinks",type:"checkbox",text:"Autolinks",checked:t.autolinks},{name:"gutter",type:"checkbox",text:"Gutter",checked:t.gutter},{name:"htmlscript",type:"checkbox",text:"Html script",checked:t.htmlscript},{name:"toolbar",type:"checkbox",text:"Toolbar",checked:t.toolbar}]},{type:"form",padding:0,labelGap:5,spacing:5,direction:"row",items:[{name:"firstline",type:"textbox",label:"First Line",size:3,value:t.firstline},{name:"highlight",type:"textbox",label:"Highlight",size:10,value:t.highlight},{name:"tabsize",type:"textbox",label:"Tab size",size:3,value:t.tabsize},]}],onsubmit:y})}tinymce.DOM.loadCSS(t+"/style/style.css");n.addButton("sh4tinymce",{icon:"sh4tinymce",tooltip:"Insert/Edit Code",onclick:i});n.addMenuItem("sh4tinymce",{text:"SH4TinyMCE",icon:"sh4tinymce",context:"insert",onclick:i})});